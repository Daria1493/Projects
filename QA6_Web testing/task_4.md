## Задание 4. Протоколы HTTP и HTTPS 

### Схема работы HTTPS-протокола

Процесс работы HTTPS делится на несколько ключевых этапов, которые обеспечивают зашифрованное и безопасное соединение между браузером пользователя и сервером. Эти этапы включают в себя установление соединения, аутентификацию, обмен ключами и шифрование данных:

1. **Установка TCP-соединения (Handshake)**. Пользователь вводит URL с префиксом `https://` в свой веб-браузер или страница перенаправляет пользователя на защищённое соединение. Браузер отправляет запрос на установление безопасного соединения с сервером.

2. **Обмен ключами и аутентификация**. В ответ на запрос веб-сервер отправляет копию публичного сертификата SSL/TLS, которая содержит публичный ключ сервера, информацию о сертификате (включая срок действия и издавшую организацию) и цифровую подпись.

3. **Проверка сертификата**. Браузер проверяет сертификат, чтобы убедиться в его подлинности. Он проверяет, что сертификат не истёк и подписан доверенным центром сертификации (CA), и что доменное имя в сертификате соответствует запрашиваемому.

4. **Обмен ключами**. После проверки сертификата браузер генерирует случайный сеансовый ключ для зашифрованного общения, шифрует его публичным ключом сервера (из сертификата) и отправляет его обратно.

5. **Завершение Handshake**. Клиент и сервер обмениваются сообщениями `Finished`, подтверждая, что Handshake успешен.

6. **Защищенный обмен данными**. Теперь и у клиента, и у сервера есть сеансовый ключ, который используется для шифрования и расшифровки данных, передаваемых между ними. Это обеспечивает конфиденциальность и целостность данных. Даже если данные перехватит злоумышленник, он не сможет их прочитать без ключа дешифрования.

7. **Разрыв соединения**. При завершении сессии TLS отправляет сообщение `close_notify` и TCP-соединение закрывается.


### Основные группы кодов состояния HTTP

Коды ответа (состояния) HTTP показывают, был ли успешно выполнен конкретный HTTP-запрос. Коды делятся на пять классов:

1. **Информационные ответы (100 – 199)**

Эти коды указывают на то, что запрос был получен, и процесс продолжается. Это способ сервера сказать: «Подождите, все еще обрабатывайте!» Они встречаются редко, в основном используются для сигнала о том, что сервер получил ваш запрос и вы можете продолжать работу. 

    100 Continue
    Этот промежуточный ответ указывает, что запрос успешно принят, и клиент может продолжать присылать запросы либо проигнорировать этот ответ, если запрос был завершён.

    101 Switching Protocols
    Этот код посылается в ответ на запрос клиента с заголовком Upgrade. Он указывает, что сервер переключился на другой протокол, который был указан в заголовке.

    102 Processing 
    Этот код указывает на то, что сервер получил запрос и обрабатывает его, но ответа пока нет.

    103 Early Hints
    Этот код состояния предназначен в основном для использования с заголовком Link, позволяя клиенту начать предварительную загрузку ресурсов, пока сервер готовит основной ответ.


2. **Успешные ответы (200 – 299)**

Означают, что запрос был успешно получен, понят и обработан. Это как большой палец вверх от сервера, подтверждающий, что он нормально получил, понял и обработал запрос. Знаменитые 200 OK означают, что все в порядке.


    200 OK
    Запрос успешно обработан

    201 Created
    Запрос успешно выполнен, и в результате был создан новый ресурс. Обычно такой ответ посылается после POST-запросов или некоторых PUT-запросов.

    202 Accepted
    Запрос был получен, но еще не обработан. Он не является обязательным, поскольку в HTTP нет возможности отправить асинхронный ответ о результатах выполнения запроса. Он предназначен для случаев, когда запрос обрабатывает другой процесс или сервер.

    203 Non-Authoritative Information
    Этот код ответа означает, что возвращаемые метаданные не полностью совпадают с теми, что имеются на исходном сервере, а собраны с локальной или сторонней копии. За исключением этого конкретного случая, ответ 200 OK предпочтительнее этого статуса.

    204 No Content
    Для этого запроса нет содержимого, но присылаются заголовки, которые могут быть полезны. Клиент может обновить свои кэшированные заголовки для данного ресурса новыми, предоставленными в этом запросе.

    205 Reset Content
    Сообщает клиенту о необходимости сбросить содержимое текущей страницы и перейти на другую страницу или выполнить другую операцию.

    206 Partial Content
    Этот код ответа используется, когда клиент отправляет заголовок Range, чтобы запросить только часть ресурса.

    207 Multi-Status 
    Используется, чтобы предоставить информацию о нескольких ресурсах в тех случаях, когда для каждого из них может быть применено разное состояние (статус). Таким образом, он собирает информацию о нескольких ресурсах и их индивидуальных состояниях и предоставляет их в одном ответе.

    208 Already Reported
    Сервер сообщает клиенту, что некоторая информация уже была передана ранее и больше не нуждается в повторной передаче. Это полезно, чтобы избежать излишней передачи одних и тех же данных, особенно когда речь идет о множестве связанных ресурсов на сервере. Клиент может использовать этот ответ, чтобы оптимизировать свои запросы и избежать ненужных повторных передач данных.

    226 IM Used
    Сервер успешно обработал GET-запрос, который был отправлен, чтобы получить информацию о ресурсе. Ответ, который клиент получает от сервера, представляет собой информацию о текущем состоянии ресурса после выполнения одной или нескольких операций над ним.

3. **Перенаправления (300 – 399)**

Указывают, что для выполнения запроса требуется предпринять дополнительные действия, например, перейти по другому URL. Сервер говорит: «Эта страница теперь находится в другом месте», как вежливый способ отправить вас в нужное место.


    300 Multiple Choices
    Запрос имеет более одного возможного ответа. Клиент должен выбрать один из них. (Стандартного способа выбора одного из ответов не существует).

    301 Moved Permanently
    URL запрашиваемого ресурса был изменен навсегда. Новый URL будет предоставлен в ответе.

    302 Found
    Этот код ответа означает, что URI запрашиваемого ресурса был временно изменен. В будущем возможны дальнейшие изменения URI. Поэтому в последующих запросах клиент должен продолжать использовать измененный URI, который был предоставлен в ответе на данный запрос.

    303 See Other
    Сервер отправил этот ответ, чтобы перенаправить клиента на получение запрашиваемого ресурса по другому URI c запросом GET.

    304 Not Modified
    Этот ответ используется для целей кэширования. Он сообщает клиенту, что запрашиваемый ресурс не был изменен, поэтому клиент может продолжать использовать кэшированную версию ответа.

    307 Temporary Redirect
    Сервер посылает этот ответ, чтобы перенаправить клиента на получение запрашиваемого ресурса по другому URI с тем же методом, который был использован в предыдущем запросе. Он имеет ту же семантику, что и HTTP-ответ 302 Found, за исключением того, клиент не должен менять используемый HTTP-метод: если в первом запросе был использован метод POST, то во втором запросе также должен быть использован POST.

    308 Permanent Redirect
    Это означает, что ресурс теперь постоянно находится на другом URI, указанном в заголовке Location: HTTP Response header. Этот код имеет ту же семантику, что и код ответа 301 Moved Permanently HTTP, за исключением того, что клиент не должен изменять используемый метод HTTP: если в первом запросе использовался POST, то и во втором запросе должен использоваться POST.

4. **Клиентские ошибки (400 – 499)**

Эти коды означают, что сервер не смог выполнить запрос из-за чего-то на стороне пользователя (например, из-за опечатки или неправильного URL-адреса). В этой категории есть классический 404 Not Found.


    400 Bad Request
    Сервер не может или не хочет обрабатывать запрос из-за ошибок клиента (например, неправильный синтаксис запроса).

    401 Unauthorized
    Хотя в стандарте HTTP указано слово “не авторизован”, семантически этот ответ означает “не аутентифицирован”. Это означает, что клиент должен пройти аутентификацию, чтобы получить запрошенный ответ.

    402 Payment Required
    Этот код ответа зарезервирован для будущего использования. Первоначальной целью создания этого кода было его использование в цифровых платежных системах. Однако, на данный момент он не используется.

    403 Forbidden
    Клиент не имеет прав доступа к содержимому, т.е. он не авторизован, поэтому сервер отказывается предоставить запрашиваемый ресурс.

    404 Not Found
    Сервер не может найти запрашиваемый ресурс. В браузере это означает, что URL не распознан. В API это также может означать, что эндпоинт действителен, но сам ресурс не существует. Этот код ответа, вероятно, наиболее известен, поскольку часто встречается в Интернете.

    405 Method Not Allowed
    Сервер знает о запрашиваемом методе, но он не может быть использован. Например, API может не разрешать вызов DELETE для удаления ресурса.

    406 Not Acceptable
    Этот ответ отправляется, когда веб-сервер, выполнив server-driven content negotiation, не находит контента, соответствующего критериям, заданным клиентом.

    407 Proxy Authentication Required
    Этот ответ аналогичен 401 Unauthorized, но требует аутентификации прокси.

    408 Request Timeout
    Этот ответ посылается некоторыми серверами при неработающем соединении, даже без какого-либо предшествующего запроса со стороны клиента. Он означает, что сервер хочет завершить неиспользуемое соединение. Этот ответ используется гораздо чаще, поскольку некоторые браузеры, например Chrome, Firefox 27+ или IE9, используют механизмы предварительного соединения HTTP для ускорения серфинга. Также следует отметить, что некоторые серверы просто закрывают соединение без отправки этого сообщения.

    409 Conflict
    Этот ответ отправляется, когда запрос противоречит текущему состоянию сервера.


5. **Серверные ошибки (500 – 599)**

Указывают на то, что запрос был принят, но сервер не смог его выполнить по своей вине (что-то сломалось на стороне сервера).


    500 Internal Server Error
    Сервер столкнулся с ситуацией, которую он не знает, как решить.

    501 Not Implemented
    Метод запроса не поддерживается сервером и не может быть обработан. Единственными методами, которые сервер обязан поддерживать (и которые, следовательно, не должны возвращать этот код), являются GET и HEAD.

    502 Bad Gateway
    Этот ответ означает, что сервер, работая в качестве шлюза для получения ответа, необходимого для обработки запроса, получил недействительный (некорректный) ответ.

    503 Service Unavailable
    Сервер не готов к обработке запроса. Обычно это связано с тем, что сервер находится на техническом обслуживании или перегружен. Обратите внимание, что вместе с этим ответом должна быть отправлена страница с объяснением проблемы. Этот ответ следует использовать временно, а HTTP-заголовок Retry-After должен, по возможности, содержать предполагаемое время восстановления работоспособности сервиса.

    504 Gateway Timeout
    Этот ответ об ошибке выдается, когда сервер выступает в роли шлюза и не может получить ответ вовремя.

    505 HTTP Version Not Supported
    Версия HTTP, используемая в запросе, не поддерживается сервером.

    506 Variant Also Negotiates
    Это означает, что на сервере произошла ошибка из-за неправильной конфигурации.

    507 Insufficient Storage
    Это означает, что сервер не может выполнить определенный метод (например, PUT или POST) на запрашиваемом ресурсе, потому что у него нет возможности сохранить информацию, которая необходима для успешного завершения этого запроса. Сервер не может обработать запрос, так как у него не хватает места или ресурсов для сохранения необходимых данных или представления.

    508 Loop Detected
    Сервер обнаружил бесконечный цикл при обработке запроса.

    510 Not Extended
    Это означает, что для выполнения запроса серверу необходимы дополнительные функциональные расширения или возможности, которые в данный момент отсутствуют.
    
    511 Network Authentication Required
    Указывает на необходимость аутентификации клиента для получения доступа к сети.


**Полный список кодов состояния HTTP смотреть [тут](<https://www.dotcom-monitor.com/wiki/knowledge-base/http-status-codes-list/>).**